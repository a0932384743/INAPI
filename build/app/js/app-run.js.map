{"version":3,"names":[],"mappings":"","sources":["app-run.js"],"sourcesContent":["(function () {\n  'use strict';\n\n  angular.module('inapi')\n    .run(run);\n\n  run.$inject = ['$rootScope', '$state', '$translate', 'i18nService', 'StorageAPI', 'SecureAuth', 'APP_CONFIG'];\n\n  /* jshint unused:false */\n  /* eslint no-unused-vars:0 */\n  function run($rootScope, $state, $translate, i18nService, StorageAPI, SecureAuth, APP_CONFIG) {\n    var stateChangeStartCB;\n\n    // 設定預設語系\n    $translate.use('zh-tw');\n    i18nService.setCurrentLang('zh-tw');\n    // 將 localStorage 的 passwordToken 讀出\n    StorageAPI.readAllToken();\n    // 設定 url redirect 條件\n    stateChangeStartCB = $rootScope.$on('$stateChangeStart',\n      function (event, toState, toParams, fromState, fromParams) {\n        var isLoggedIn = SecureAuth.isLogin();\n        if (toState.data && toState.data.needLogin && !isLoggedIn) {\n          event.preventDefault();\n          StorageAPI.setReturnState(toState.name);\n          $state.go(APP_CONFIG.loginState);\n        } else if (toState.data && toState.data.escapeIfLoggedIn && isLoggedIn) {\n          event.preventDefault();\n          $state.go(APP_CONFIG.firstStateAfterLogin);\n        }\n      }\n    );\n  }\n}());\n"],"file":"app-run.js"}